<%@LANGUAGE="JAVASCRIPT" CODEPAGE="65001"%>
<%var $=new Object();(function(){var a=(function(){var d=function(e,f){return new d.fn.init(e,f)},c=Array.prototype.push,b=Object.prototype.hasOwnProperty;d.fn=d.prototype={init:function(e,f){return d.makeArray(e,this,f)},syQuery:"2.0",constructor:d,length:0,object:null,size:function(){return this.length}};d.error=[];d.setError=function(e){this.error.push(e)};d.getError=function(f){var e=$.isFunction(f)?f.call(d.error):f;return this.error.join(e)};d.config={method:{},charset:"utf-8",setup:{}};d.config.method.mix=function(h,g,f,e){if(e||!(h in g)){g[h]=f[h]}};d.config.ActivexObject={conn:"ADODB.CONNECTION",record:"ADODB.RECORDSET",fso:"Scripting.FileSystemObject",stream:"Adodb.Stream",xmlhttp:"Microsoft.XMLHTTP",xml:"Microsoft.XMLDOM",winhttp:"WinHttp.WinHttpRequest.5.1"};d.config.method.retMake_array=function(e,f){return d.merge(this,e,f)};d.config.method.retMake_object=function(e,f){if(e==undefined){return this}else{if(typeof e.length==="number"){return d.merge(this,e,f)}else{c.call(this,e);this.object=f||null;return this}}};d.config.method.retMake_undefined=function(e,f){return this};d.config.method.retMake_null=function(e,f){return this};d.config.retArray=["function","string","boolean","number","date"];d.dataTypeArray=["Function","String","Array","Object","Boolean","Undefined","Null","Number","Date"];d.dataSpecialTypeArray=[{matchData:{}.constructor,domain:"isJson"},{matchData:d.fn.constructor,domain:"isQuery"}];d.type=function(e){return Object.prototype.toString.apply(e).split(" ")[1].toLowerCase().replace("]","")};d.arrEach=function(j,h,e){var f=0;if(e==undefined){for(var g=j[0];f<j.length&&h.call(g,f,g)!==false;g=j[++f]){}}else{for(;f<length;){if(h.apply(j[f++],e)===false){break}}}return j};d.jsonEach=function(g,h,e){var f;if(e==undefined){for(f in g){if(h.call(g[f],f,g[f])===false){break}}}else{for(f in g){if(h.apply(g[f],e)===false){break}}}return g};d.each=function(f,g,e){if(d.isJson(f)||$.isNewFunction(f)||$.isFunction(f)){return d.jsonEach(f,g,e)}else{if(d.isArray(f)||$.isQuery(f)){return d.arrEach(f,g,e)}else{return f}}};d.arrEach(d.dataTypeArray,function(f,e){d["is"+e]=function(g){return this.type(g)==e.toLowerCase()}});d.arrEach(d.dataSpecialTypeArray,function(f,e){d[e.domain]=function(g){return g.constructor==e.matchData}});d.isNewFunction=function(f){if($.isObject(f)){if($.isJson(f)){return false}else{for(var e in f){}return e===undefined||b.call(f,e)}}else{return false}};d.arrEach(d.config.retArray,function(){d.config.method["retMake_"+this]=function(e,f){c.call(this,e);this.object=f||null;return this}});d.isEmObject=function(g){if(!g){return false}var f,e=0;for(f in g){e++}if($.isJson(g)){return e==0}else{return f===undefined||b.call(g,f)}};d.echo=function(f,g,e){if(g==undefined){Response.Write(f);return}if(e==undefined){Response.Write(g.call(f));return}Response.Write(g.apply(f,e))};d.die=function(){this.echo.apply(undefined,arguments);Response.End()};d.mix=function(h,l,k,f){if(!h||!l){return h}if(k==undefined){k=true}var e,g,j;if(f&&(e=f.length)){for(g=0;g<e;g++){j=f[g];if(j in l){d.config.method.mix(j,h,l,k)}}}else{for(j in l){d.config.method.mix(j,h,l,k)}}return h};d.extend=d.fn.extend=function(i,j,h){var e=i||{},g=j||{},f=h||[];if(!j&&!h){e=this;g=i}return d.mix(e,g,true,f)};d.makeArray=function(f,e,h){var g=this.type(f),i=d.config.method["retMake_"+g];if(this.isFunction(i)){return i.call(e,f,h)}else{return e}};d.merge=function(k,e,h){var m=k.length,g=0;if(typeof e.length==="number"){for(var f=e.length;g<f;g++){k[m++]=e[g]}}else{while(e[g]!==undefined){k[m++]=e[g++]}}k.length=m;k.object=h||null;return k};d.fn.init.prototype=d.fn;return d})();$=a})();(function(){var b=String.prototype.trim,h=/^\s+/,a=/\s+$/,c=/^[\],:{}\s]*$/,d=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,e=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,g=/(?:^|:|,)(?:\s*\[)+/g,f=Array.prototype.slice;split=String.prototype.split,replace=String.prototype.replace,substr=String.prototype.substr,indexOf=String.prototype.indexOf,lastIndexOf=String.prototype.lastIndexOf,publicMethodFunction=[{method:split,methodName:"split"},{method:replace,methodName:"replace"},{method:substr,methodName:"substr"},{method:indexOf,methodName:"indexOf"},{method:lastIndexOf,methodName:"lastIndexOf"}];$.extend({trim:b?function(i){return i==(null||undefined)?"":b.call(i)}:function(i){return i==(null||undefined)?"":i.toString().replace(h,"").replace(a,"")},out:function(k,j){return k.slice(0,j).concat(k.slice(j+1))},Enumerator:function(j,i,l){if(i==undefined){i=[];l=null}else{if(l==undefined){if($.isFunction(i)){l=i;i=[]}else{if($.isArray(i)){l=null}else{i=[];l=null}}}}try{j=new Enumerator(j);for(;!j.atEnd();j.moveNext()){if($.isFunction(l)){i.push(l.call(j.item()))}else{i.push(j.item())}}}catch(k){}return i},querys:function(i,j){if(i==undefined){i=Request.QueryString;j=null}else{if($.isFunction(i)){j=i;i=Request.QueryString}else{i=Request.QueryString(i)}}return this.Enumerator(i,j)},posts:function(i,j){if(i==undefined){i=Request.Form;j=null}else{if($.isFunction(i)){j=i;i=Request.Form}else{i=Request.Form(i)}}return this.Enumerator(i,j)},query:function(i,j){return this.querys(i,j)[0]},post:function(i,j){return this.posts(i,j)[0]},map:function(j,p){var k=[],n,o=this;for(var l=0,m=j.length;l<m;l++){n=p.call(j,l,j[l]);if(n!=null){k[k.length]=n}}return k.concat.apply([],k)},grep:function(k,p,j){var l=[],o;j=!!j;for(var m=0,n=k.length;m<n;m++){o=!!p(k[m],m);if(j!==o){l.push(k[m])}}return l},inArray:function(l,m){if(m.indexOf){return m.indexOf(l)}for(var j=0,k=m.length;j<k;j++){if(m[j]===l){return j}}return -1},parseDate:function(i){var i=Date.parse(i);return isNaN(i)?"":i},isDateTime:function(i){if($.isDate(i)){return true}else{return $.parseDate(i)!=""}},date:function(m,i){function l(q){var p="";for(var o=0;o<q.length;o++){var k=q.charAt(o);if(n[k]){p+=(n[k])()}else{p+=k}}return p}var n={shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longMonths:["January","February","March","April","May","June","July","August","September","October","November","December"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longDays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],d:function(){return(j.getDate()<10?"0":"")+j.getDate()},w:function(){return syQuery.trim(this.r().split(" ")[0])},W:function(){return(function(){var p=n.w(),o="";for(var k=0;k<n.shortDays.length;k++){if(n.shortDays[k]==p){o=n.longDays[k];break}}return o})()},F:function(){return n.longMonths[j.getMonth()]},m:function(){return(j.getMonth()<9?"0":"")+(j.getMonth()+1)},Y:function(){return j.getFullYear()},y:function(){return(""+j.getFullYear()).substr(2)},a:function(){return j.getHours()<12?"am":"pm"},A:function(){return j.getHours()<12?"AM":"PM"},H:function(){return(j.getHours()<10?"0":"")+j.getHours()},I:function(){return(j.getMinutes()<10?"0":"")+j.getMinutes()},S:function(){return(j.getSeconds()<10?"0":"")+j.getSeconds()},z:function(){return j.getTime()}},j=new Date();if(m==undefined){m="Y/m/d H:I:S";return l(m)}if(i==undefined){if($.isDateTime(m)){i=$.isDate(m)?m:(new Date($.parseDate(m)));m="Y/m/d H:I:S"}else{i=new Date()}j=i;return l(m)}if($.isDateTime(i)){i=$.isDate(i)?i:(new Date($.parseDate(i)));j=i;return l(m)}else{return""}},now:function(j){return $.date(j)},parseJSON:function(i){if(i==undefined||!$.isString(i)){return null}i=$.trim(i);if(c.test(i.replace(d,"@").replace(e,"]").replace(g,""))){return(new Function("return "+i))()}else{$.setError("Invalid JSON: "+i)}},getSession:function(i){return Session(i)},setSession:function(i,j){Session(i)=j},session:function(k,l){if(l==undefined){if($.isJson(k)){for(var j in k){$.setSession(j,k[j])}}else{if($.isString(k)){return $.getSession(k)}}}else{$.setSession(k,l)}},removeSession:function(i){if($.isString(i)){Session.Contents.Remove(i)}else{if($.isArray(i)){$.arrEach(i,function(l,j){$.removeSession(j)})}else{Session.Contents.RemoveAll()}}},getCookie:function(i){var j=i.split(".");if(j.length==2){return Request.Cookies(j[0])(j[1])}else{return Request.Cookies(i)}},setCookie:function(k,n,p,m){var l=k.split("."),i="";if(l.length==2){Response.Cookies(l[0])(l[1])=n;i=l[0]}else{Response.Cookies(k)=n;i=k}if(p!=undefined){var j=(new Date()).getTime();var o=j+parseInt(p*24*60*60*1000);Response.Cookies(i).Expires=$.date("F d,Y",(new Date(o)))}if(m!=undefined){Response.Cookies(i).Domain=m}},cookie:function(m,o,p,n){if(o==undefined){if($.isJson(m)){for(var l in m){var q=m[l];if($.isJson(q)){for(var k in q){$.setCookie(l+"."+k,q[k],p,n)}}else{$.setCookie(l,q,p,n)}}}else{return $.getCookie(m)}}else{$.setCookie(m,o,p,n)}},removeCookie:function(i){if($.isArray(i)){$.arrEach(i,function(l,j){$.removeCookie(j)})}else{Response.Cookies(i).Expires="1/1/1980"}},makeJsonParme:function(j,l){var i='"'+j+'"',k="";if($.isString(l)){k='"'+escape(l)+'"'}else{if($.isNumber(l)){k=l}else{if($.isBoolean(l)){k=String(l).toLowerCase()}}}if(k!=""){return i+":"+k}else{return""}},makeJson:function(l,m){if(m==undefined){var k,j=[];if($.isArray(l)){$.arrEach(l,function(o,n){if($.isArray(n)){j.push($.makeJsonParme(n[0],n[1]))}else{if($.isJson(n)){for(o in n){j.push($.makeJsonParme(o,n[o]))}}}})}else{if($.isJson(l)){for(k in l){j.push($.makeJsonParme(k,l[k]))}}}j=$.map(j,function(o,n){if(n==""){return null}else{return n}});return"{"+j.join(",")+"}"}else{return"{"+$.makeJsonParme(l,m)+"}"}},toArray:function(l){var j=[];for(var k=0;k<l.length;k++){j.push(l[k])}return j},getIP:function(){var i=String(Request.ServerVariables("HTTP_X_FORWARDED_FOR")).toLowerCase();if(i=="undefined"){i=String(Request.ServerVariables("REMOTE_ADDR")).toLowerCase()}return i},active:function(i){return new ActiveXObject(i)},param:function(i){var j=[],k=function(l,m){m=$.isFunction(m)?m():m;j[j.length]=encodeURIComponent(l)+"="+encodeURIComponent(m)};if($.isArray(i)){$.arrEach(i,function(m,l){k(l[0],l[1])})}else{if($.isJson(i)){$.jsonEach(i,function(m,l){k(m,l)})}}return j.join("&").replace(/%20/g,"+")},mat:function(j,i,k){return $.map(j.match(i),function(m,l){var n=i.exec(l);if(n){if($.isFunction(k)){return k.call(n,l)}else{return null}}else{return null}})}});$.fn.extend({each:function(j,i){return $.each(this,j,i)},map:function(i){return $.makeArray($.map(this,i),$(),this.object)},trim:function(){return this.map(function(l,j){return $.trim(j)})},toArray:function(){return f.call(this,0)},out:function(j){return $.makeArray($.out(this.toArray(),j),$(),this.object)},echo:function(){var o=arguments;if(o.length==0){$.echo(this.get(0));return}var l=0,p="",n,k,m;for(var i=0;i<o.length;i++){if($.isString(o[i])){p=o[i]}else{if($.isNumber(o[i])){l=o[i]}else{if($.isFunction(o[i])){n=o[i]}else{if($.isArray(o[i])){k=o[i]}}}}}if(l==0){m=this.toArray().join(p)}else{m=this.toArray().slice(0,l).join(p)}$.echo(m,n,k)},get:function(i){return i==undefined?this.toArray():(i<0?this.slice(i)[0]:this[i])},eq:function(j){return j===-1?this.slice(j):this.slice(j,+j+1)},slice:function(){return $.makeArray(f.apply(this,arguments),$(),this.object)},left:function(j){return this.substr(0,j)},right:function(j){return this.substr(this.size()-j,j)},mid:function(k,j){return this.substr(k-1,j)},instr:function(i){this.indexOf(i)},instrrev:function(i){return this.lastIndexOf(i)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},parseDate:function(){return this.map(function(l,j){return $.parseDate(j)})},date:function(i){return this.map(function(l,j){return $.date(i,j)})},lcase:function(){return this.map(function(l,j){return j.toLowerCase()})},ucase:function(){return this.map(function(l,j){return j.toUpperCase()})},removeHTML:function(){return this.replace(/<[^>]*?>/g,"").replace(/\n\t\r/g,"")},removeUBB:function(){return this.replace(/\[(\w+).*?\](.+)\[\/\1\]/g,"$2").replace(/\n\t\r/g,"")},cutStr:function(i){return this.map(function(o,m){var n=0,l="";for(var o=0;o<m.length;o++){if(!/[^\u4E00-\u9FA5]/g.test(m.charAt(o))){n=n+2}else{n=n+1}l+=m.charAt(o);if(n>=(2*i)){break}}if(l!=m){l+="..."}return l})}});$.arrEach(publicMethodFunction,function(){var i=this;$.fn[i.methodName]=function(){var j=arguments;return this.map(function(m,l){return i.method.apply(l,j)})}})})();(function(){$.extend({conn:function(){return $.active($.config.ActivexObject.conn)},open:function(c,i){if(c==undefined){$.setError("未定义错误");return{success:false,object:null}}if(i==undefined||!$.isObject(i)){i=$.conn()}var d={method:"access",userName:"",userPass:"",serverNs:"",baseName:""},h=function(e){var j="";for(var k=0;k<e;k++){j+="../"}return j},f=function(j,e){return j.method==="access"?"provider=Microsoft.jet.oledb.4.0;data source="+Server.MapPath(h(e)+j.serverNs):"PROVIDER=MSDASQL;DRIVER={SQL Server};SERVER="+j.serverNs+";DATABASE="+j.baseName+";UID="+j.userName+";PWD="+j.userPass+";"},a=function(m,l,e){if(b>=10){$.setError("未找到指定的Access数据库文件");return{success:false,object:null}}try{tempSQL=f(l,e);m.Open(tempSQL);return{success:true,object:m}}catch(k){b++;return a(m,l,++e)}},b=0;if($.isString(c)){d.serverNs=c}else{if($.isJson(c)){d=$.extend(d,c)}}try{return a(i,d,0)}catch(g){$.setError(g.message);return{success:false,object:null}}},recloy:{sysLoop:function(a,b){a.MoveFirst();while(!a.Eof){b.call(a)}}},msProtect:function(d,a){if(a!=undefined){d.BeginTrans();try{if($.isFunction(a.success)){a.success()}d.CommitTrans()}catch(b){if($.isFunction(a.failure)){a.failure(b)}d.RollbackTrans()}}},record:function(b){if(b==undefined){return $.active($.config.ActivexObject.record)}if(!$.isJson(b)){return null}if(b.conn==undefined){return null}if(b.rs==undefined){b.rs=$.active($.config.ActivexObject.record)}if(b.hook==undefined){return b.rs}if($.isJson(b.hook)){b.hook=[b.hook]}if(!$.isArray(b.hook)){return b.rs}var a=function(){for(var d=0;d<b.hook.length;d++){var c=b.hook[d];if(c.sql==undefined){continue}if(c.type==undefined){continue}b.rs.Open(c.sql,b.conn,1,c.type);if($.isFunction(c.callback)){if(c.callback.call($.recloy,b.rs,b.conn)==false){continue}}b.rs.Close()}};if(b.protect==true){$.msProtect(b.conn,{success:a,failure:b.onError})}else{a()}if($.isFunction(b.complete)){b.complete()}},rows:function(d){var a=function(f,k){var e=f.length/k,m=[],l;for(var h=0;h<e;h++){m[h]=new Array();l=h*k;for(var g=0;g<k;g++){m[h][g]=f[l+g]}}return m};var b=[];try{b=d.GetRows().toArray()}catch(c){}return a(b,d.Fields.Count)}});$.fn.extend({select:function(b,a){var c=$.map(this,function(e,d){if(!$.isJson(d)){return null}if(d.type==undefined){d.type=3}return d});if(c.length>0){$.record({rs:a,conn:b,hook:c})}},record:function(c,b,a){var d=$.map(this,function(g,f){if(f!=undefined){var h={};if(f.method==="update"||f.method==="delete"){h.sql="Select * From "+f.table+" Where "+f.pKey+"="+f.pKeyValue;h.type=3}else{h.sql="Select * From "+f.table;h.type=2}h.callback=function(l,n){if(f.method==="insert"){l.AddNew()}var k,m;if($.isFunction(f.callback)){k=f.callback.call(l,n)}if(k==false){return}m=f.data;if(f.method==="delete"){l.Delete()}else{if($.isJson(m)){m=[m]}for(var j=0;j<m.length;j++){l(m[j].key)=m[j].text}l.Update()}};return h}else{return null}});var e={rs:a,conn:c,hook:d};if(b!=undefined){if(b.complete!=undefined){e.complete=b.complete}if(b.protect!=undefined){e.protect=b.protect}if(b.onError!=undefined){e.onError=b.onError}}$.record(e)},insert:function(d,c,b,f){var e=this.toArray(),a={table:c,method:"insert",data:e,pKey:b};if(f!=undefined){a.callback=f}$(a).record(d)},update:function(d,c,b,f,g){var e=this.toArray(),a={table:c,method:"update",data:e,pKey:b,pKeyValue:f};if(g!=undefined){a.callback=g}$(a).record(d)},scrap:function(d,c,b,f,g){var e=this.toArray(),a={table:c,method:"delete",data:e,pKey:b,pKeyValue:f};if(g!=undefined){a.callback=g}$(a).record(d)}})})();(function(){$.extend({formatpath:function(a){return a.replace(/\/$/,"")},DFT:function(a){if(a==undefined){a="f"}if(a!="f"&&a!="o"){a="f"}return a},fso:function(){return $.active($.config.ActivexObject.fso)},create:function(c,h){try{c=$.formatpath(c).split("/");var a="",g="";for(var b=0;b<c.length;b++){a+=c[b]+"/";g=$.formatpath(a);h.CreateFolder(Server.MapPath(g))}return true}catch(d){$.setError(d.message);return false}},name:function(c,f,h,a){a=$.DFT(a);c=$.formatpath(c);var b,g=c;try{if(a=="o"){b=h.GetFolder(Server.MapPath(c))}else{b=obj.GetFile(Server.MapPath(c))}if(b){b.Name=f}g=g.split("/").slice(0,-1).join("/")+"/"+f}catch(d){$.setError(d.message)}return g}});$.fn.extend({exsit:function(a){a=$.DFT(a);return a=="o"?this.object.FolderExists(Server.MapPath(this.get(0))):this.object.FileExists(Server.MapPath(this.get(0)))},create:function(){return this.map(function(b,a){if($.create(a,this.object)==true){return this}else{return null}})},collect:function(a,b){a=$.DFT(a);return this.map(function(f,c){c=$.formatpath(c);var e=this.object.GetFolder(Server.MapPath(c)),g,d;if(a=="o"){d=e.SubFolders}else{d=e.Files}if($.isFunction(b)){g=$.Enumerator(d,[],function(){return b.call(this,c)})}else{if(b==true){g=$.Enumerator(d,[],function(){return c+"/"+this.Name})}else{g=$.Enumerator(d,[],function(){return this.Name})}}return g})},_delete:function(a){a=$.DFT(a);return this.map(function(c,b){b=$.formatpath(b);var f=b;try{if(a=="o"){this.object.DeleteFolder(Server.MapPath(b))}else{this.object.DeleteFile(Server.MapPath(b))}f=null}catch(d){$.setError(d.message)}return f})},_deletes:function(a){return this.collect(a,true)._delete(a)},move:function(b,a){a=$.DFT(a);b=$.formatpath(b);return this.map(function(f,d){d=$.formatpath(d);var h=null;try{var j=d.split("/").slice(-1).join(""),c=b+"/"+j;if(a=="o"){this.object.MoveFolder(Server.MapPath(d),Server.MapPath(c))}else{this.object.MoveFile(Server.MapPath(d),Server.MapPath(c))}h=c}catch(g){$.setError(g.message)}return h})},moves:function(b,a){return this.collect(a,true).move(b,a)},copy:function(b,a){a=$.DFT(a);b=$.formatpath(b);return this.map(function(f,d){d=$.formatpath(d);var h=null;try{var j=d.split("/").slice(-1),c=b+"/"+j;if(a=="o"){this.object.CopyFolder(Server.MapPath(d),Server.MapPath(c))}else{this.object.CopyFile(Server.MapPath(d),Server.MapPath(c))}h=c}catch(g){$.setError(g.message)}return h})},copys:function(b,a){return this.collect(a,true).copy(b,a)},name:function(b,a){return this.map(function(d,c){return $.name(c,b,this.object,a)})},filecreate:function(){this.map(function(b,a){a=a.split("/").slice(0,-1).join("/");return a}).create();return this}})})();(function(){$.config.setup.stream={Mode:3};$.extend({stream:function(){return $.active($.config.ActivexObject.stream)},loader:function(f,b,g,a){if(b!=1){b=2}var d=false;f.Type=b;f.Mode=$.config.setup.stream.Mode;f.Open();try{d=g.call(f,b,a)}catch(c){$.setError(c.message)}f.Close;return d},load:function(b,c,a){return $.loader(c,a,function(d){if(d==2){this.Charset=$.config.charset}if(d==2){this.Position=this.Size}else{this.Position=0}this.LoadFromFile(Server.MapPath(b));if(d==1){return this.Read()}else{return this.ReadText}})},save:function(b,c,d,a){return $.loader(d,a,function(e){if(e==2){this.Charset=$.config.charset}if(e==1){this.Position=0;this.write(b)}else{this.Position=this.Size;this.WriteText=b}this.SaveToFile(Server.MapPath(c),2);return true})},bin:function(a,b){return $.loader(b,1,function(c){b.Write(a);b.Position=0;b.Type=2;b.Charset=$.config.charset;return b.ReadText})}});$.fn.extend({load:function(a){return $.loader(this.object,a,function(b,c){var d=this;if(b==2){this.Charset=$.config.charset}return c.map(function(f,e){if(b==2){d.Position=d.Size}else{d.Position=0}d.LoadFromFile(Server.MapPath(e));if(b==1){return d.Read()}else{return d.ReadText}})},this)},save:function(b,a){if(!$.isArray(b)){b=[b]}return this.map(function(e,d){var c=$.save(d,b[e],this.object,a);if(c==false){return null}return b[e]})},bin:function(){return this.map(function(b,a){return $.bin(a,this.object)})}})})();(function(){$.extend({uploadSetting:{speed:1000,object:null,splitLine:"",finline:"",area:{},filenameExpr:/filename=\"([^\"]+)\"/i,nameExpr:/name=\"([^\"]+)\"/i,contentTypeExpr:/Content-Type: ([^\n\r]+)/i},uploadConfig:{readBinary:function(d){var b=Request.TotalBytes,e=$.uploadSetting.speed,c=0,f=0,a;if(b<e){e=b}d.Open();d.Type=1;while(c<b){if(c+e<b){f=e}else{f=b-c}c+=f;d.Write(Request.BinaryRead(f))}d.Position=0;a=d.Read();d.Close();return a},html5:function(e,c){e=e[0];var b=$.uploadSetting.nameExpr.exec(e),a=$.uploadSetting.filenameExpr.exec(e),d=$.uploadSetting.contentTypeExpr.exec(e);binaryData=$.uploadConfig.readBinary(object);if(b){$.uploadSetting.area[b[1]]={};if(a){$.uploadSetting.area[b[1]].filename=a[1];$.uploadSetting.area[b[1]].size=Request.TotalBytes;$.uploadSetting.area[b[1]].ext=a[1].split(".").slice(-1).join("");$.uploadSetting.area[b[1]].contentType=d[1];$.uploadSetting.area[b[1]].fileSavePath=$.uploadConfig.writePath(c,$.uploadSetting.area[b[1]]);$(binaryData,$.stream()).save($.uploadSetting.area[b[1]].fileSavePath,1)}else{if($.isFunction(c.onError)){c.onError.call({message:"找不到文件名，文件已损坏或废弃。"})}}}else{if($.isFunction(c.onError)){c.onError.call({message:"不支持HTML5控件"})}}},writePath:function(c,a){var b=c.savePath.replace(/\/$/,"");if($.isArray(c.saveType)){return b+"/"+c.saveType.join(".")}else{if(c.saveType=="old"){return b+"/"+a.filename}else{if(c.saveType=="time"){return b+"/"+$.now("z")+"."+a.ext}}}return b+"/"+$.now("z")+"."+a.ext},fileExtMatch:function(b,d){var c=false;for(var a=0;a<d.length;a++){if(d[a]===b){c=true;break}}return c}},upload:function(l){l=$.extend({saveType:"time",savePath:"upload",extArray:["jpg","png","gif","bmp","rar","zip"]},l||{});if($.isFunction(l.beforeUpload)){if(l.beforeUpload()==false){return}}var f=$.Enumerator(Request.ServerVariables("HTTP_CONTENT_DISPOSITION")),j,k;if(f.length>0){j=$.uploadConfig.html5(f,l)}else{var d=$.uploadSetting.object=$.stream(),b,g,a,i=[];j=$.uploadConfig.readBinary(d);d.Type=2;d.Open();d.WriteText(j);d.Position=0;d.Charset="ascii";d.Position=2;k=d.ReadText;$.uploadSetting.splitLine=k.split("\n")[0];$.uploadSetting.splitLineLength=$.uploadSetting.splitLine.length;$.uploadSetting.finline=$.uploadSetting.splitLine.substring(0,$.uploadSetting.splitLine.length-1);$.uploadSetting.finlineLength=$.uploadSetting.finline.length;b=k;g=0;var c,e,h;while((a=b.indexOf($.uploadSetting.splitLine))!=-1){c=g;e=c+a;h=b.substring(0,a);b=b.substring(a+$.uploadSetting.splitLineLength);g=e+$.uploadSetting.splitLineLength;i.push({data:h,start:c,end:e})}if((a=b.indexOf($.uploadSetting.finline))!=-1){c=g;e=c+a;h=b.substring(0,a);i.push({data:h,start:c,end:e})}$(i).map(function(o,n){if(/^\n+/.test(n.data)){n.start+=/^\n+/.exec(n.data)[0].length;n.data=n.data.replace(/^\n+/,"")}var m=n.data.split("\n\r");n.start+=(n.data.indexOf(m[1])+1);n.data=m[0];n.textValue=m.slice(1,-1).join("");return n}).each(function(n,m){if($.uploadSetting.nameExpr.test(m.data)){var o=$.uploadSetting.nameExpr.exec(m.data),p=o[1];$.uploadSetting.area[p]={};if($.uploadSetting.filenameExpr.test(m.data)){o=$.uploadSetting.filenameExpr.exec(m.data);$.uploadSetting.area[p].filename=o[1];o=$.uploadSetting.contentTypeExpr.exec(m.data);$.uploadSetting.area[p].contentType=o[1];$.uploadSetting.area[p].ext=$.uploadSetting.area[p].filename.split(".").slice(-1).join("");$.uploadSetting.area[p].size=m.end-m.start}$.uploadSetting.area[p].STARTPOS=m.start;$.uploadSetting.area[p].ENDPOS=m.end}});$.jsonEach($.uploadSetting.area,function(o,n){if(n.filename!=undefined&&n.filename.length>0){if($.uploadConfig.fileExtMatch(n.ext,l.extArray)==false){if($.isFunction(l.onError)){l.onError.call({message:"上传格式不匹配"})}}else{try{var m=$.stream();m.Type=1;m.Mode=3;m.Open();d.Position=n.STARTPOS+2;d.CopyTo(m,n.size);n.fileSavePath=$.uploadConfig.writePath(l,n);m.SaveToFile(Server.MapPath(n.fileSavePath),2);m.Close();m=null;if($.isFunction(l.onSuccess)){l.onSuccess.call(n)}}catch(p){if($.isFunction(l.onError)){l.onError.call(p)}}}}else{$.uploadSetting.area[o].value=k.substring(n.STARTPOS,n.ENDPOS-2)}})}return $.uploadSetting.area}})})();(function(){$.extend({winhttp:function(){return $.active($.config.ActivexObject.winhttp)},winSetup:function(a){return $.extend({url:"",type:"GET",async:false,contentType:"application/x-www-form-urlencoded",dataType:"text"},a||{})},win:function(b,a){if(a==undefined){a=$.winhttp()}var d=$.winSetup(b);var e={addUrl:function(g,h){var f=g.indexOf("?");if(f==-1){h=g+"?"+$.param(h)}else{if(/\?$/.test(g)){h=g+$.param(h)}else{h=g+"&"+$.param(h)}}return h}};if(d.type=="GET"&&d.data!=undefined){d.url=e.addUrl(d.url,d.data);d.data=null}else{if(d.data==undefined){d.data=null}else{d.data=$.param(d.data)}}a.Open(d.type,d.url,d.async);a.Option(4)=13056;a.Option(6)=false;if(d.type=="POST"){obj.setRequestHeader("Content-Type",d.contentType)}if(d.header!=undefined){for(var c in d.header){if(c=="Cookie"){a.setRequestHeader("Cookie","string")}a.setRequestHeader(c,d.header[c])}}if(d.referer!=undefined){a.setRequestHeader("Referer",d.referer)}a.Send(d.data);if(a.WaitForResponse()){if(d.dataType=="text"){if($.isFunction(d.onSuccess)){d.onSuccess.call(a,a.ResponseText)}}else{if(d.dataType=="json"){if($.isFunction(d.onSuccess)){d.onSuccess.call(a,$.parseJSON(a.ResponseText))}}}}else{if($.isFunction(d.onError)){d.onError.call(a)}}a.abort()},winGet:function(b,d,c,a){if(a==undefined){a={}}else{if($.isString(a)){a={dataType:a}}}if(!$.isJson(a)){a={}}a.type="GET";a.url=b;a.data=d;a.onSuccess=c;return $.win(a)},winPost:function(b,d,c,a){if(a==undefined){a={}}else{if($.isString(a)){a={dataType:a}}}if(!$.isJson(a)){a={}}a.type="Post";a.url=b;a.data=d;a.onSuccess=c;return $.win(a)}})})();(function(){$.extend({xmlConfig:{match:{chunker:/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/,ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/g,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/g,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/g,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/g,GT:/\>/g,SPLITEXPR:/^(\w+?)\[(.+?)\]$/},formatSelector:function(a){return $(a.split(",")).trim().map(function(e,c){var d={set:"",expr:c},b=[];while(d.expr.length>0){d=$.xmlConfig.exprMatch.chunker(d);b.push($.xmlConfig.exprMatch.Mac(d.set))}return b}).toArray()},exprMatch:{chunker:function(b){var a=$.xmlConfig.match.chunker.exec(b.expr);if(a){b.set=$.trim(a[1]);b.expr=$.trim(a[3]);return b}else{return{set:"",expr:""}}},Mac:function(b){var a=["ATTR","TAG","CHILD","POS","PSEUDO","GT"],e;for(var d=0;d<a.length;d++){var c=a[d];if($.xmlConfig.match[c].test(b)){b=$.xmlConfig.toBeMethod[c].call(b)}}return b}},toBeMethod:{ATTR:function(){return this.replace($.xmlConfig.match.ATTR,"{ATTR['$1','$4']}")},TAG:function(){return this.replace($.xmlConfig.match.TAG,"{TAG['$1']}")},CHILD:function(){return this.replace($.xmlConfig.match.CHILD,"{CHILD['$1','$2']}")},POS:function(){return this.replace($.xmlConfig.match.POS,"{POS['$1','$2']}")},PSEUDO:function(){return this.replace($.xmlConfig.match.PSEUDO,"{PSEUDO['$1','$3']}")},GT:function(){return this.replace($.xmlConfig.match.GT,"{GT}")}},callback:{TAG:function(a){return $.map(this,function(c,b){var d=b.getElementsByTagName(a);if(d.length==0){return null}return $.toArray(b.getElementsByTagName(a))})},ATTR:function(a,b){return $.map(this,function(d,c){try{return c.getAttribute(a)==b?c:null}catch(f){return null}})},CHILD:function(a,b){return $.xmlConfig.callChild[a](this,b)},POS:function(a,b){return $.xmlConfig.callChild[a](this,b)}},callChild:{first:function(a){return[a[0]]||[]},last:function(a){return a.slice(-1)||[]},nth:function(p,h){var g=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(h);if(g){if(!/n/.test(h)){var n=parseInt(h)-1;return[p[n<0?0:n]]}else{var c=g[1],l=g[2],j=g[3],d=p.length,f,m,o=[];if(l==""){l="0"}if(j==""){j=="0"}l=parseInt(c+l)||0;j=parseInt(j)||0;if(c=="-"){f=Math.ceil((d-j)/l);m=Math.floor((1-j)/l)}else{f=Math.ceil((1-j)/l);m=Math.floor((d-j)/l)}for(var e=f;e<=m;e++){o.push(p[l*e+j-1])}return o}}else{return[]}},odd:function(a){return this.nth(a,"2n")},even:function(a){return this.nth(a,"2n+1")},eq:function(b,a){return this.nth(b,a)},lt:function(b,a){return $.map(b,function(d,c){if(d<a){return c}else{return null}})},gt:function(b,a){return $.map(b,function(d,c){if(d>a){return c}else{return null}})}}},xml:function(f){var c=$.active($.config.ActivexObject.xml),a,b=true;if(f==undefined){return[null,c]}try{c.load(Server.MapPath(f))}catch(d){try{c.loadXML(f)}catch(d){b=false}}if(b==true){a=c.documentElement}else{a=null}return[a,c]},attr:function(c,a,b){if(b!=undefined){c.setAttribute(a,""+b)}else{if($.isJson(a)){$.jsonEach(a,function(e,d){c.setAttribute(e,""+d)})}else{if($.isString(a)){if(!c.attributes[a]&&(c.hasAttribute&&!c.hasAttribute(a))){return""}else{return c.getAttribute(a)}}else{return""}}}},append:function(d,b,e,a){var c=e.createElement(b);d.appendChild(c);if(a){return d}else{return c}}});$.fn.extend({find:function(a){var b=$.xmlConfig.formatSelector(a);return this.map(function(g,d){var c=[d];for(var g=0;g<b.length;g++){var p=b[g].replace(/^\{/,"").replace(/\}$/,"").split("}{"),m,l,h,f;for(var e=0;e<p.length;e++){var o=$.xmlConfig.match.SPLITEXPR.exec(p[e]);if(o){m=o[1];f=o[2].split(",");if(f.length==2){l=f[0].replace(/^\'/,"").replace(/\'$/,"");h=f[1].replace(/^\'/,"").replace(/\'$/,"")}else{l=f[0].replace(/^\'/,"").replace(/\'$/,"");h=""}var n=[l];if(h!=""){n.push(h)}c=$.xmlConfig.callback[m].apply(c,n)}}}return c})},attrs:function(a,b){return this.map(function(d,c){return $.attr(c,a,b)})},attr:function(a,b){return $.attr(this[0],a,b)},removeAttr:function(a){return this.each(function(c,b){$.attr(b,a,"");if(b.nodeType===1){b.removeAttribute(a)}})},append:function(b,a){return this.map(function(f,e){if($.isArray(b)){var d=[];for(var f=0,c=b.length;f<c;f++){d.push($.append(e,b[f],this.object,a))}return d}if($.isFunction(b)){return $.append(e,b.call(e,this.object),this.object,a)}return $.append(e,b,this.object,a)})},empty:function(){for(var a=0,b;(b=this[a])!=null;a++){while(b.firstChild){b.removeChild(b.firstChild)}}return this},saveXML:function(a){this.object.save(Server.MapPath(a));return this},html:function(a){if(a==undefined){var b=this.get(0).firstChild||null;if(b===null){return""}if(b.nodeType==4){return b.text}return b.xml}else{var c=this.object;this.empty().each(function(f,d){if($.isString(a)){if(a.toLowerCase()=="null"){a=""}}if(a==null){a=""}var g=c.createCDATASection(a+""||"");d.appendChild(g)});return this}},text:function(b){if(b!=undefined){var c=this.object;this.empty().each(function(f,d){if($.isString(b)){if(b.toLowerCase()=="null"){b=""}}if(b==null){b=""}var g=c.createTextNode(b);d.appendChild(g)});return this}else{var a=this.get(0).firstChild||null;if(a===null){return""}return a.text}},remove:function(){this.each(function(b,a){try{a.parentNode.removeChild(a)}catch(c){}})},xsl:function(d){var a=$.xml(),c=this.object;a[1].async=false;a[1].load(Server.MapPath(d));c.async=false;try{return c.transformNode(a[1])}catch(b){return b.message}},parent:function(){var a=this.get(0).parentNode;return a&&a.nodeType!==11?$(a,this.object):$([],this.object)},parents:function(b){var d=this,a=[],c=$(this.object.documentElement,this.object).find(b);while(d.get(0)!=this.object.documentElement){d=d.parent();if(b!=undefined){if($.grep(c,function(g,f){return g==d.get(0)},false).length>0){a.push(d.get(0))}}else{a.push(d.get(0))}}return $(a,this.object)}});$.jsonEach({next:"nextSibling",prev:"previousSibling"},function(a,b){$.fn[a]=function(){try{return $(this.get(0)[b],this.object)}catch(c){return $([],this.object)}}})})();(function(){$.extend({xmlhttp:function(){return $.active($.config.ActivexObject.xmlhttp)},ajaxSettings:{dataType:{text:"responseText",binary:"responseBody",xml:"responseXML",stream:"responseStream"},accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":"*/*"}},ajaxSetup:function(a){return $.extend({url:null,type:"GET",contentType:"application/x-www-form-urlencoded",async:false,dataType:"text",onBeforeOpen:null,onBeforeSend:null,onHttped:null,onSending:null,onSuccess:null,onNotModify:null,onNotFound:null,onForbid:null,onServerError:null,onTimeout:null,onOtherError:null,readyState:0,status:0,callbackSub:null},a||{})},ajax:function(b,d){if(d==undefined){d=$.xmlhttp()}var c=$.ajaxSetup(b);c.status=0;c.readyState=0;var a={callReadyStateFn:function(e,f){if($.isFunction(e)){e.call(f)}},onReadyStateChange:function(){c.readyState=d.readyState;switch(c.readyState){case 0:a.callReadyStateFn(c.onBeforeOpen,d);break;case 1:a.callReadyStateFn(c.onBeforeSend,d);break;case 2:a.callReadyStateFn(c.onHttped,d);break;case 3:a.callReadyStateFn(c.onSending,d);break;default:a.readyComplete.call(d)}},readyComplete:function(){c.status=d.status;switch(c.status){case 200:a.statusCallback.onSuccess.call(d);break;case 304:a.statusCallback.onNotModify.call(d);break;case 404:a.statusCallback.onNotFound.call(d);break;case 405:a.statusCallback.onForbid.call(d);break;case 500:a.statusCallback.onServerError.call(d);break;case 504:a.statusCallback.onTimeout.call(d);break;default:a.readyComplete.call(d,c.status)}},subCallback:function(e){if(e=="text"||e=="binary"||e=="stream"||e=="xml"){return[this[$.ajaxSettings.dataType[e]]]}if(e=="json"){return[$.parseJSON(this.responseText)]}},statusCallback:{onSuccess:function(){c.callbackSub=a.subCallback.call(this,c.dataType);if($.isFunction(c.onSuccess)){c.onSuccess.apply(d,c.callbackSub)}},onNotModify:function(){if($.isFunction(c.onNotModify)){c.onNotModify.call(d)}},onNotFound:function(){if($.isFunction(c.onNotFound)){c.onNotModify.call(d)}},onForbid:function(){if($.isFunction(c.onForbid)){c.onForbid.call(d)}},onServerError:function(){if($.isFunction(c.onServerError)){c.onServerError.call(d)}},onTimeout:function(){if($.isFunction(c.onTimeout)){c.onTimeout.call(d)}},onOtherError:function(e){if($.isFunction(c.onOtherError)){c.onOtherError.call(d,e)}}},addUrl:function(f,g){var e=f.indexOf("?");if(e==-1){g=f+"?"+$.param(g)}else{if(/\?$/.test(f)){g=f+$.param(g)}else{g=f+"&"+$.param(g)}}return g}};if(c.type=="GET"&&c.data!=undefined){c.url=a.addUrl(c.url,c.data);c.data=null}else{if(c.data==undefined){c.data=null}else{c.data=$.param(c.data)}}if(c.username!=undefined){d.open(c.type,c.url,c.async,c.username,c.password)}else{d.open(c.type,c.url,c.async)}d.onreadystatechange=a.onReadyStateChange;if(c.type=="POST"){d.setRequestHeader("Content-Type",c.contentType)}d.send(c.data);d.abort();return c.callbackSub},send:function(b,a){if(b==undefined){return}if(a==undefined){a={url:b}}return $.ajax(a)},ajaxGet:function(b,d,c,a){if(a==undefined){a={}}else{if($.isString(a)){a={dataType:a}}}if(!$.isJson(a)){a={}}a.type="GET";a.url=b;a.data=d;a.onSuccess=c;return $.ajax(a)},ajaxPost:function(b,d,c,a){if(a==undefined){a={}}else{if($.isString(a)){a={dataType:a}}}if(!$.isJson(a)){a={}}a.type="POST";a.url=b;a.data=d;a.onSuccess=c;return $.ajax(a)},ajaxGetJson:function(a,c,b){return $.ajaxGet(a,c,b,"json")},ajaxPostJson:function(a,c,b){return $.ajaxPost(a,c,b,"json")}})})();%>