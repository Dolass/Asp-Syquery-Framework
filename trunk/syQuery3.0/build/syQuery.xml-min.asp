<%$.add("xml",function(){var c=new ActiveXObject($.config.ActivexObject.xml),b=$("xml",c);var d={hack:/((nth|eq|gt|lt|first|last|even|odd|not)(\((.+)\))?)/g,nth:/(-?)(\d*)(n([+\-]?\d*))?/,tag:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,attr:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/g};$.mix(b,{load:function(g){var f=false;try{f=c.loadXML(g);if(!f){try{f=c.load(Server.MapPath(g))}catch(h){f=false}}}catch(h){try{f=c.load(Server.MapPath(g))}catch(h){f=false}}if(f!==false){return c.documentElement}else{return false}}});$.fn.extend({getElementsByTagName:function(e){return this.map(function(g,f){var h=f.getElementsByTagName(e);return h.length===0?null:a(h)})},getElementsByAttr:function(e,f){return this.map(function(h,g){try{return g.getAttribute(e)===f?g:null}catch(j){return null}})},getElementsByHack:function(g){var f=d.hack.exec(g),e;return this[f[2]].call(this,f[4])},nth:function(f){if(this.length===0){return this}var j=d.nth.exec(f),e=j[1],k=j[2],p=j[4],o=this.length;k=k==""?"0":k;p=p==""?"0":p;var h=Number(e+k),g=Number(p);var n,q,l=[];if(e=="-"){n=Math.ceil((o-g)/h);q=Math.floor((1-g)/h)}else{n=Math.ceil((1-g)/h);q=Math.floor((o-g)/h)}for(var m=n;m<=q;m++){l.push(h*m+g-1)}return this.map(function(i,r){return l.indexOf(i)!==-1?r:null})},not:function(g){var f=a(this),e=a(this.getElementsByHack(g));f=f.map(function(j,h){return e.indexOf(h)===-1?h:null});return f.toQuery(this,this.object)},attr:function(f,g){if(g==undefined){if($.isJson(f)){for(var e in f){this.attr(e,f[e])}return this}else{return this[0].getAttribute(f)}}else{this.each(function(h,i){i.setAttribute(f,g+"")});return this}},removeAttr:function(e){return this.map(function(g,f){f.setAttribute(e,"");if(f.nodeType===1){f.removeAttribute(e)}return f})},append:function(e,f){return this.map(function(j,h){var g=this.object.createElement(e);h.appendChild(g);if(f==undefined){return g}else{return h}})},empty:function(){for(var e=0,f;(f=this[e])!=null;e++){while(f.firstChild){f.removeChild(f.firstChild)}}return this},html:function(f){if(f==undefined){var e=this[0]||null;if(e===null){return""}if(e.nodeType==4){return e.text}return e.xml}else{this.empty().each(function(h,g){if($.isString(f)){if(f.toLowerCase()=="null"){f=""}}if(f==null){f=""}g.appendChild(this.object.createCDATASection(f+""||""))});return this}},text:function(f){if(f==undefined){var e=this[0]||null;if(e===null){return""}return e.text}else{this.empty().each(function(h,g){if($.isString(f)){if(f.toLowerCase()=="null"){f=""}}if(f==null){f=""}var j=this.object.createTextNode(f);g.appendChild(j)});return this}},remove:function(){this.each(function(g,f){try{f.parentNode.removeChild(f)}catch(h){}})},parent:function(){return this.map(function(f,e){var g=e.parentNode;return g&&g.nodeType!==11?g:null})},next:function(){return this.map(function(g,f){var e=f.nextSibling||null;return e})},prev:function(){return this.map(function(g,f){var e=f.previousSibling||null;return e})},saveXML:function(e){this.object.save(Server.MapPath(e));return this}});function a(g){var e=[];for(var f=0;f<g.length;f++){e.push(g[f])}return e}return b});%>