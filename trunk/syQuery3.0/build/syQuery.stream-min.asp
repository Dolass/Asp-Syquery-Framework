<%$.add("stream",function(){var a=function(b){if(b==undefined){b=3}this.object=new ActiveXObject($.config.ActivexObject.stream);this.loader=function(h,g){if(h!==1){h=2}var c=this.object,d;c.Type=h;c.Mode=b;c.Open();try{d=g(c)}catch(f){$.error.push("ACTX STM Error : ["+f.message+"]")}c.Close;return d}};$.augment(a,{load:function(c,b,d){return this.loader(b,function(e){if(b===2){e.Charset=$.charset}var f;e.Position=b===2?e.Size:0;e.LoadFromFile(Server.MapPath(c));f=b===2?e.ReadText:e.Read();return $.isFunction(d)?d(f):f})},save:function(d,c,b,e){return this.loader(b,function(f){if(b===2){f.Charset=$.charset}if(b===2){f.Position=f.Size;f.WriteText=d}else{f.Position=0;f.write(d)}f.SaveToFile(Server.MapPath(c),2);return $.isFunction(e)?e():true})},bin:function(b,c){return this.loader(1,function(d){d.Write(b);d.Position=0;d.Type=2;d.Charset=$.charset;return c?c.call(d,d.ReadText):d.ReadText})}});$.fn.extend({load:function(c){var b=new a();return this.map(function(d,e){return b.load(e,c)})},save:function(c,d){var b=new a();return this.map(function(e,f){return b.save(f,c,d)})},bin:function(){var b=new a();return this.map(function(c,d){return b.bin(d)})}});return a});%>