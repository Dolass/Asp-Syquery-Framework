<%$.add("fso",function(){var c=$("fso",new ActiveXObject($.config.ActivexObject.fso));$.fn.extend({exsit:function(e){return e?this.object.FolderExists(Server.MapPath(this.get(0))):this.object.FileExists(Server.MapPath(this.get(0)))},create:function(){this.each(function(f,e){e=a(e);b(e,this.object)});return this},collect:function(e,f){return this.map(function(j,h){h=a(h);var m=this.object.GetFolder(Server.MapPath(h)),g=e?m.SubFolders:m.Files,l;if($.isFunction()){data=$.Enumerator(g,[],function(i){return f.call(this,i)})}else{if(f===true){data=$.Enumerator(g,[],function(i){return h+"/"+i.Name})}else{data=$.Enumerator(g,[],function(i){return i.Name})}}return data})},destory:function(e){this.each(function(g,f){f=a(f);try{if(e){this.object.DeleteFolder(Server.MapPath(f))}else{this.object.DeleteFile(Server.MapPath(f))}}catch(h){}})},destorys:function(e){this.collect(e,true).destory(e)},move:function(f,e){f=a(f);return this.map(function(j,h){h=a(h);var l=h.split("/").slice(-1),g=f+"/"+l;if(e){this.object.MoveFolder(Server.MapPath(h),Server.MapPath(g))}else{this.object.MoveFile(Server.MapPath(h),Server.MapPath(g))}return g||null})},moves:function(f,e){return this.collect(e,true).move(f,e)},copy:function(g,e,f){g=a(g);return this.map(function(l,j){j=a(j);var m=j.split("/").slice(-1),h=g+"/"+m;if(e){this.object.CopyFolder(Server.MapPath(j),Server.MapPath(h))}else{this.object.CopyFile(Server.MapPath(j),Server.MapPath(h))}return f?j:(h||null)})},copys:function(g,e,f){return this.collect(e,true).copy(g,e,f)},name:function(g,e,f){return this.map(function(j,h){var l;h=a(h);if(e){l=this.object.GetFolder(Server.MapPath(h))}else{l=this.object.GetFile(Server.MapPath(h))}if(l){l.Name=g}return f?h.split("/").slice(0,-1).join("/")+"/"+g:g})}});function d(e){return e==undefined?new ActiveXObject($.config.ActivexObject.fso):e}function a(e){return e.replace(/\/+$/,"")}function b(k,m){var h=k.split("/"),f="",l="";for(var g=0;g<h.length;g++){f+=h[g]+"/";l=a(f);try{m.CreateFolder(Server.MapPath(l))}catch(j){}}}return c});%>