<%$.add("xmlhttp",function(){var c=function(){var e=this;e.type="GET";e.dataType="text";e.async=false;e.object=new ActiveXObject($.config.ActivexObject.xmlhttp);e.contentType="application/x-www-form-urlencoded";e.send=function(){var g=e.object;if(e.type.toUpperCase()=="GET"&&e.data!=undefined){e.url=a(e.url,e.data);e.data=null}else{if(e.data==undefined){e.data=null}}if(this.userName){g.open(e.type.toUpperCase(),e.url,e.async,e.username,e.password)}else{g.open(e.type.toUpperCase(),e.url,e.async)}g.onreadystatechange=function(){var h=e.core;switch(g.readyState){case 0:if($.isFunction(h.onBeforeOpen)){h.onBeforeOpen.call(g)}break;case 1:if($.isFunction(h.onBeforeSend)){h.onBeforeSend.call(g)}break;case 2:if($.isFunction(h.onHttped)){h.onHttped.call(g)}break;case 3:if($.isFunction(h.onSending)){h.onSending.call(g)}break;default:h.onReady(g)}};if(e.type.toUpperCase()=="POST"){g.setRequestHeader("Content-Type",t.contentType)}g.send(e.data);return this};this.abort=function(){this.object.abort()};this.core={onReady:function(g){var i=e.core,h=f(g);switch(g.status){case 200:if($.isFunction(i.onSuccess)){i.onSuccess.call(g,h)}break;case 304:if($.isFunction(i.onNotModify)){i.onNotModify.call(g,h)}break;case 404:if($.isFunction(i.onNotFound)){i.onNotFound.call(g,h)}break;case 405:if($.isFunction(i.onForbid)){i.onForbid.call(g,h)}break;case 500:if($.isFunction(i.onServerError)){i.onServerError.call(g,h)}break;case 504:if($.isFunction(i.onTimeout)){i.onTimeout.call(g,h)}break;default:if($.isFunction(i.onError)){i.onError.call(g,g.status)}}}};var f=function(g){if(e.dataType==="json"){return $.parseJson(g[b.text])}else{if(e.dataType==="asp"){return(new Function(g[b.text]))()}else{return g[b[e.dataType]]}}}};$.augment(c,{setUrl:function(e){this.url=e;return this},setContentType:function(e){this.contentType=e;return this},setData:function(e){if($.isJson(e)){this.data=d(e)}else{this.data=e}return this},setType:function(e){this.type=e;return this},setAsync:function(e){this.anync=e;return this},setConfirm:function(e,f){this.userName=e;this.password=f;return this},setHeader:function(e){this.setHeader=e;return this},setCore:function(f,g){if(g==undefined){for(var e in f){this.core[e]=f[e]}}else{this.core[f]=g}return this},success:function(e){this.core.onSuccess=e;return this},setDataType:function(e){this.dataType=e;return this}});$.mix(c,{post:function(f,h,i,e){var g=this;g=g.type("POST");g=g.url(f);g=g.success(i);g=g.setDataType(e||"text");if(h){g=g.data(h)}g.send().abort()},get:function(f,h,i,e){var g=this;g=g.type("GET");g=g.url(f);g=g.success(i);g=g.setDataType(e||"text");if(h){g=g.data(h)}g.send().abort()}});function d(h){var e=[];for(var g in h){var f=h[g];if($.isArray(f)){f.each(function(l,i){e.push(g+"="+i)})}else{e.push(g+"="+f)}}return e.join("&")}function a(f,e){if(f.indexOf("?")===-1){f+="?"+e}else{if(/\?$/.test(f)){f+=e}else{f+="&"+e}}return f}var b={text:"responseText",binary:"responseBody",xml:"responseXML",stream:"responseStream"};return c});%>